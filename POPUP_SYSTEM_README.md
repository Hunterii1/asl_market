# ๐ฏ ุณุณุชู ูพุงูพโุขูพ ุงุดุชุฑุงฺฉ ู ุขููุฒุด

## ๐ ุฎูุงุตู

ุงู ุณุณุชู ุจู ุตูุฑุช ููุดููุฏ ูพุงูพโุขูพโูุง ุชุจูุบุงุช ุจุฑุง ุฎุฑุฏ ุงุดุชุฑุงฺฉ ู ุซุจุชโูุงู ุฏุฑ ุฏูุฑู ุขููุฒุด ุฑุงฺฏุงู ุฑุง ููุงุด ูโุฏูุฏ.

## ๐ฌ ุณูุงุฑููุง ููุงุด

### 1๏ธโฃ ฺฉุงุฑุจุฑ ูููุงู (Guest - ูุงฺฏู ูฺฉุฑุฏู)

**ุฒูุงู ููุงุด:** ุจุนุฏ ุงุฒ **1.5 ุฏููู** ุญุถูุฑ ุฏุฑ ุณุงุช

**ูุญุชูุง ูพุงูพโุขูพ:**
- โ ฺฏุฒูู ุซุจุชโูุงู/ูุฑูุฏ ุฏุฑ ูพูุชูุฑู
- โ ุขููุฒุด ุฑุงฺฏุงู 4 ุฑูุฒู ุตุงุฏุฑุงุช
- โ ุฎุฑุฏ ูุณุชูู ุงุดุชุฑุงฺฉ (ุจุง ุดูุงุฑูโูุง ุชูุงุณ)

**ููุงูู:**
- ููุท **ฺฉ ุจุงุฑ** ุจู ูุฑ ูููุงู ูุดุงู ุฏุงุฏู ูโุดูุฏ
- ุฐุฎุฑู ุฏุฑ **localStorage** (ุฑุณุช ุจุนุฏ ุงุฒ 24 ุณุงุนุช)

---

### 2๏ธโฃ ฺฉุงุฑุจุฑ ูุงฺฏู ุดุฏู ุจุฏูู ูุงุณูุณ

#### ุญุงูุช A: ุจูุงูุงุตูู ุจุนุฏ ุงุฒ ูุงฺฏู

**ุฒูุงู ููุงุด:** **ููุฑุงู** ุจุนุฏ ุงุฒ ูุงฺฏู ูููู

**ูุญุชูุง ูพุงูพโุขูพ:**
- โ ุขููุฒุด ุฑุงฺฏุงู 4 ุฑูุฒู ุตุงุฏุฑุงุช
- โ ุฎุฑุฏ ูุณุชูู ุงุดุชุฑุงฺฉ

**ููุงูู:**
- ููุท **ฺฉ ุจุงุฑ** ุจุนุฏ ุงุฒ ุงููู ูุงฺฏู
- ุฐุฎุฑู ุฏุฑ **ุฏุชุงุจุณ** (`has_seen_post_login_popup`)

---

#### ุญุงูุช B: ุจุนุฏ ุงุฒ ฺุฑุฎุฏู ุฏุฑ ุณุงุช

**ุฒูุงู ููุงุด:** ุจุนุฏ ุงุฒ **2 ุฏููู** ูุนุงูุช ุฏุฑ ูพูุชูุฑู

**ูุญุชูุง ูพุงูพโุขูพ:**
- โ ุขููุฒุด ุฑุงฺฏุงู 4 ุฑูุฒู ุตุงุฏุฑุงุช
- โ ุฎุฑุฏ ูุณุชูู ุงุดุชุฑุงฺฉ

**ููุงูู:**
- ููุท **ฺฉ ุจุงุฑ** ูุดุงู ุฏุงุฏู ูโุดูุฏ
- ุฐุฎุฑู ุฏุฑ **ุฏุชุงุจุณ** (`has_seen_browsing_popup`)

---

### 3๏ธโฃ ฺฉุงุฑุจุฑ ุจุง ูุงุณูุณ ูุนุงู

**ููุงุด:** โ ูฺ ูพุงูพโุขูพ ูุดุงู ุฏุงุฏู ููโุดูุฏ

---

## ๐๏ธ ูุนูุงุฑ ูู

### Backend (Go)

#### ูุฏู User - ููุฏูุง ุฌุฏุฏ:
```go
HasSeenLicensePopup       bool       // ุจุฑุง ุขูุฏู
LicensePopupShownAt       *time.Time
HasSeenPostLoginPopup     bool       // ูพุงูพโุขูพ ุจุนุฏ ุงุฒ ูุงฺฏู
PostLoginPopupShownAt     *time.Time
HasSeenBrowsingPopup      bool       // ูพุงูพโุขูพ ุจุนุฏ ุงุฒ 2 ุฏููู
BrowsingPopupShownAt      *time.Time
```

#### API Endpoints:

##### 1. ฺฺฉ ูุถุนุช ูพุงูพโุขูพ
```
GET /api/v1/popup/status
Authorization: Bearer {token}

Response:
{
  "should_show_popup": true,
  "popup_type": "post_login" | "browsing",
  "has_license": false,
  "message": "Show post-login popup"
}
```

##### 2. ุซุจุช ุฏุฏู ูพุงูพโุขูพ
```
POST /api/v1/popup/mark-seen
Authorization: Bearer {token}
Content-Type: application/json

{
  "popup_type": "post_login"
}

Response:
{
  "message": "Popup marked as seen",
  "popup_type": "post_login"
}
```

##### 3. ุฑุณุช ูุถุนุช (ุชุณุช)
```
POST /api/v1/popup/reset
Authorization: Bearer {token}

Response:
{
  "message": "Popup status reset successfully"
}
```

---

### Frontend (React + TypeScript)

#### ฺฉุงููพูููุชโูุง:

**1. LicensePromptPopup.tsx**
- UI ูพุงูพโุขูพ ุจุง 2 ุง 3 ฺฏุฒูู
- CTA ุจุฑุง ุชูุงุณ ู ุจุงุฒ ฺฉุฑุฏู ููฺฉโูุง

**2. LicensePopupManager.tsx**
- ูุฏุฑุช ููุงุด ูพุงูพโุขูพ

**3. useLicensePopup.ts (Hook)**
- ูุงุฌฺฉ ุชุงูุฑูุง ู ฺฺฉ ูุถุนุช
- ูุฏุฑุช localStorage ุจุฑุง ูููุงูโูุง
- ุงุชุตุงู ุจู API ุจุฑุง ฺฉุงุฑุจุฑุงู ูุงฺฏู ุดุฏู

---

## ๐ ุงุทูุงุนุงุช ุชูุงุณ ุฏุฑ ูพุงูพโุขูพ

### ุฏูุชุฑ ุชูุฑุงู:
- ๐ 021-88922936
- ๐ 021-88922939

### ูพุดุชุจุงู ุชูฺฏุฑุงู:
- ๐ฑ 0912-021-1407
- ๐ https://t.me/incoming_center

### ุฏูุฑู ุขููุฒุด:
- ๐ https://alirezaasll.com/registration/

---

## ๐จ ุทุฑุงุญ UI

### ุฑูฺฏโุจูุฏ:
- **ุซุจุชโูุงู:** ุณุจุฒ (`green-600`)
- **ุขููุฒุด:** ุขุจ (`blue-600`)
- **ุฎุฑุฏ:** ูุงุฑูุฌ (`orange-600`)

### ุขฺฉููโูุง:
- ๐ค UserPlus: ุซุจุชโูุงู
- ๐ GraduationCap: ุขููุฒุด
- ๐ณ CreditCard: ุฎุฑุฏ
- ๐ Phone: ุชูุงุณ
- ๐ ExternalLink: ููฺฉ ุฎุงุฑุฌ

---

## ๐งช ุชุณุช

### ุชุณุช ุจุฑุง ูููุงู:
1. ุจุงุฒ ฺฉุฑุฏู ุณุงุช ุจุฏูู ูุงฺฏู
2. ุตุจุฑ ฺฉุฑุฏู 1.5 ุฏููู
3. ุจุงุฏ ูพุงูพโุขูพ ุจุง 3 ฺฏุฒูู ููุงุด ุฏุงุฏู ุดูุฏ
4. ุจุณุชู ูพุงูพโุขูพ
5. ุฑูุฑุด ุตูุญู โ ูพุงูพโุขูพ ูุจุงุฏ ุฏูุจุงุฑู ุจุงุฏ

### ุชุณุช ุจุฑุง ฺฉุงุฑุจุฑ ูุงฺฏู ุดุฏู:
1. ูุงฺฏู ฺฉุฑุฏู ุจุง ุญุณุงุจ ุจุฏูู ูุงุณูุณ
2. ุจูุงูุงุตูู ุจุงุฏ ูพุงูพโุขูพ ูุดุงู ุฏุงุฏู ุดูุฏ
3. ุจุณุชู ูพุงูพโุขูพ
4. ฺุฑุฎุฏู ุฏุฑ ุณุงุช
5. ุจุนุฏ ุงุฒ 2 ุฏููู ุจุงุฏ ูพุงูพโุขูพ ุฏูู ุจุงุฏ
6. ุจุณุชู ู ูุงฺฏู ุฏูุจุงุฑู โ ูุจุงุฏ ูพุงูพโุขูพ ุจุงุฏ

### ุฑุณุช ุจุฑุง ุชุณุช:
```javascript
// ุฏุฑ Console ูุฑูุฑฺฏุฑ:
localStorage.removeItem('asl_guest_popup_shown');
localStorage.removeItem('asl_guest_popup_timestamp');

// ุง API call:
fetch('/api/v1/popup/reset', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_TOKEN'
  }
});
```

---

## ๐ ุฏูพูู

### 1. Migration ุฏุชุงุจุณ:
```bash
mysql -u asl_user -p asl_market < backend/migrations/add_popup_tracking_fields.sql
```

### 2. ุฑุณุชุงุฑุช ุจฺฉโุงูุฏ:
```bash
cd backend
go run main.go
```

### 3. ุจูุฏ ูุฑุงูุช:
```bash
npm run build
```

---

## ๐ ุขูุงุฑ ู ฺฏุฒุงุฑุด

ุจุฑุง ูุดุงูุฏู ุขูุงุฑ ูพุงูพโุขูพโูุง ูโุชูุงูุฏ ุงุฒ ุงู query ุงุณุชูุงุฏู ฺฉูุฏ:

```sql
-- ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู ฺฉู ูพุงูพโุขูพ ุฏุฏูโุงูุฏ
SELECT 
  COUNT(*) as total_users,
  SUM(CASE WHEN has_seen_post_login_popup THEN 1 ELSE 0 END) as seen_post_login,
  SUM(CASE WHEN has_seen_browsing_popup THEN 1 ELSE 0 END) as seen_browsing
FROM users
WHERE deleted_at IS NULL;

-- ุขุฎุฑู ุฒูุงู ููุงุด ูพุงูพโุขูพโูุง
SELECT 
  id, first_name, last_name,
  post_login_popup_shown_at,
  browsing_popup_shown_at
FROM users
WHERE (post_login_popup_shown_at IS NOT NULL 
       OR browsing_popup_shown_at IS NOT NULL)
  AND deleted_at IS NULL
ORDER BY COALESCE(post_login_popup_shown_at, browsing_popup_shown_at) DESC
LIMIT 20;
```

---

## ๐ง ุชูุธูุงุช

### ุชุบุฑ ุฒูุงู ุชุงูุฑ:

**ุจุฑุง ูููุงู (1.5 ุฏููู โ X ุฏููู):**
```typescript
// ุฏุฑ src/hooks/useLicensePopup.ts
const timer = setTimeout(() => {
  setShowLoginOption(true);
  setShowPopup(true);
}, X * 60 * 1000); // ุชุบุฑ X
```

**ุจุฑุง ฺฉุงุฑุจุฑ ูุงฺฏู (2 ุฏููู โ Y ุฏููู):**
```typescript
// ุฏุฑ src/hooks/useLicensePopup.ts
setTimeout(() => {
  setShowLoginOption(false);
  setShowPopup(true);
}, Y * 60 * 1000); // ุชุบุฑ Y
```

---

## โ ฺฺฉโูุณุช ูพุงุฏูโุณุงุฒ

- [x] โ ุงุถุงูู ฺฉุฑุฏู ููุฏูุง ุจู User model
- [x] โ ุณุงุฎุช popup tracking controller
- [x] โ ุงุถุงูู ฺฉุฑุฏู routes ุจู backend
- [x] โ ุณุงุฎุช LicensePromptPopup component
- [x] โ ุณุงุฎุช useLicensePopup hook
- [x] โ ุณุงุฎุช LicensePopupManager
- [x] โ ุงุถุงูู ฺฉุฑุฏู ุจู App.tsx
- [x] โ ุงุถุงูู ฺฉุฑุฏู types ุจู api.ts
- [x] โ ุณุงุฎุช migration SQL
- [x] โ ููุดุชู ูุณุชูุฏุงุช

---

## ๐ ูุชุฌู

ุณุณุชู ูพุงูพโุขูพ ุจู ุตูุฑุช ฺฉุงูู ูพุงุฏูโุณุงุฒ ุดุฏู ู ุขูุงุฏู ุงุณุชูุงุฏู ุงุณุช!

**ูฺฺฏโูุง ฺฉูุฏ:**
- โ ููุงุด ููุดููุฏ ุจุฑ ุงุณุงุณ ูุถุนุช ฺฉุงุฑุจุฑ
- โ ุชุงูุฑูุง ุฏูู ุจุฑุง ูุฑ ุณูุงุฑู
- โ ุฌููฺฏุฑ ุงุฒ ุชฺฉุฑุงุฑ (ฺฉ ุจุงุฑ ููุงุด)
- โ ุทุฑุงุญ ุฒุจุง ู ฺฉุงุฑุจุฑูพุณูุฏ
- โ CTAโูุง ูุงุถุญ ุจุฑุง ุชูุงุณ ู ุซุจุชโูุงู
- โ ูพุดุชุจุงู ุงุฒ ุญุงูุช ุชุงุฑฺฉ
- โ Responsive ุจุฑุง ููุจุงู
